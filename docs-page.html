<!DOCTYPE html>
<html lang="en">
<head>
    <title>
      Jake: JavaScript build tool / task runner for NodeJS
    </title>

    <!-- Meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="description" content="The original JavaScript build tool / task runner for NodeJS">
    <meta name="author" content="mde@fleegix.org">
    <link rel="shortcut icon" href="favicon.ico">

    <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700&display=swap" rel="stylesheet">

    <!-- FontAwesome JS-->
    <script defer src="assets/fontawesome/js/all.min.js"></script>
    <script defer src="assets/js/highlight.pack.js"></script>

    <!-- Plugins CSS -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.2/styles/atom-one-dark.min.css">

    <!-- Theme CSS -->
    <link id="theme-style" rel="stylesheet" href="assets/css/theme.css">
    <link id="theme-style" rel="stylesheet" href="assets/css/theme-override.css">
    <link id="theme-style" rel="stylesheet" href="assets/css/routeros.css">

</head>

<body class="docs-page">
    <header class="header fixed-top">
        <div class="branding docs-branding">
            <div class="container-fluid position-relative py-2">
                <div class="docs-logo-wrapper">
                  <div class="site-logo">
                    <a class="navbar-brand" href="index.html">
                      <img src="assets/images/cowboy_hat.png" class="logo-img-sm" alt="Cowboy Hat"/>
                      <span class="logo-text">Jake<span class="text-alt">.js</span></span>
                    </a>
                  </div>
                </div><!--//docs-logo-wrapper-->
              <div class="docs-top-utilities d-flex justify-content-end align-items-center">

                <ul class="social-list list-inline mx-md-3 mx-lg-5 mb-0 d-none d-lg-flex">
                  <li class="list-inline-item"><a href="docs-page.html"><i class="fas fa-edit fa-fw"></i></a></li>
                  <li class="list-inline-item"><a href="https://github.com/jakejs/jake"><i class="fab fa-github fa-fw"></i></a></li>
                  <li class="list-inline-item"><a href="https://www.npmjs.com/package/jake"><i class="fab fa-npm fa-fw"></i></a></li>
                  <li class="list-inline-item"><a href="https://twitter.com/mde"><i class="fab fa-twitter fa-fw"></i></a></li>
                </ul><!--//social-list-->
              </div><!--//docs-top-utilities-->
            </div><!--//container-->
        </div><!--//branding-->
    </header><!--//header-->

    <div class="docs-wrapper">
      <div id="docs-sidebar" class="docs-sidebar">
        <div class="top-search-box d-lg-none p-3">
                <form class="search-form">
                <input type="text" placeholder="Search the docs..." name="search" class="form-control search-input">
                <button type="submit" class="btn search-btn" value="Search"><i class="fas fa-search"></i></button>
            </form>
            </div>
        <nav id="docs-nav" class="docs-nav navbar">
          <ul class="section-items list-unstyled nav flex-column pb-3">
            <li class="nav-item section-title"><a class="nav-link scrollto active" href="#section-overview"><span class="theme-icon-holder mr-2"><i class="fas fa-map-signs"></i></span>Overview</a></li>
            <li class="nav-item"><a class="nav-link scrollto" href="#item-overview-installation">Installation</a></li>
            <li class="nav-item"><a class="nav-link scrollto" href="#item-overview-basic-usage">Basic usage</a></li>
            <li class="nav-item"><a class="nav-link scrollto" href="#item-overview-jakefiles">Jakefiles</a></li>
            <li class="nav-item"><a class="nav-link scrollto" href="#item-overview-showing-tasks">Showing tasks</a></li>
            <li class="nav-item section-title mt-3"><a class="nav-link scrollto" href="#section-api"><span class="theme-icon-holder mr-2"><i class="fas fa-box"></i></span>API</a></li>
            <li class="nav-item"><a class="nav-link scrollto" href="#item-api-tasks">Tasks</a></li>
            <li class="nav-item"><a class="nav-link scrollto" href="#item-api-task-method">The <code>task</code> method</a></li>
            <li class="nav-item"><a class="nav-link scrollto" href="#item-api-desc-method">The <code>desc</code> method</a></li>
            <li class="nav-item"><a class="nav-link scrollto" href="#item-api-task-examples">Task examples</a></li>
            <li class="nav-item"><a class="nav-link scrollto" href="#item-api-exported-function-tasks">Exported function tasks</a></li>
            <li class="nav-item"><a class="nav-link scrollto" href="#item-api-series-method">The <code>series</code> method</a></li>
            <li class="nav-item"><a class="nav-link scrollto" href="#item-api-file-tasks">File tasks</a></li>
            <li class="nav-item"><a class="nav-link scrollto" href="#item-api-directory-tasks">Directory tasks</a></li>
            <li class="nav-item"><a class="nav-link scrollto" href="#item-api-namespaces">Namespaces</a></li>
            <li class="nav-item"><a class="nav-link scrollto" href="#item-api-rules">Rules</a></li>
            <li class="nav-item section-title mt-3"><a class="nav-link scrollto" href="#section-advanced-usage"><span class="theme-icon-holder mr-2"><i class="fas fa-cogs"></i></span>Advanced usage</a></li>
            <li class="nav-item"><a class="nav-link scrollto" href="#item-advanced-usage-concurrent-tasks">Concurrent tasks</a></li>
            <li class="nav-item"><a class="nav-link scrollto" href="#item-advanced-usage-passing-parameters">Passing parameters</a></li>
            <li class="nav-item"><a class="nav-link scrollto" href="#item-advanced-usage-programmatic-tasks">Programmatic tasks</a></li>
            <li class="nav-item"><a class="nav-link scrollto" href="#item-advanced-usage-evented-tasks">Evented tasks</a></li>
            <li class="nav-item"><a class="nav-link scrollto" href="#item-advanced-usage-aborting-tasks">Aborting tasks</a></li>
            <li class="nav-item"><a class="nav-link scrollto" href="#item-advanced-usage-modularizing">Modularizing</a></li>
            <li class="nav-item section-title mt-3"><a class="nav-link scrollto" href="#section-utility-tasks"><span class="theme-icon-holder mr-2"><i class="fas fa-tools"></i></span>Utility tasks</a></li>
            <li class="nav-item"><a class="nav-link scrollto" href="#item-utility-tasks-package-task">PackageTask</a></li>
            <li class="nav-item"><a class="nav-link scrollto" href="#item-utility-tasks-file-list">FileList</a></li>
            <li class="nav-item"><a class="nav-link scrollto" href="#item-utility-tasks-publish-task">PublishTask</a></li>
          </ul>

        </nav><!--//docs-nav-->
      </div><!--//docs-sidebar-->
      <div class="docs-content">
        <div class="container">
          <article class="docs-article" id="section-overview">
            <header class="docs-header">
              <h1 class="docs-heading">Overview</h1>
              <section class="docs-intro">
                <p>
                  Jake is the JavaScript build tool for NodeJS. Jake has been
                  around since the very early days of Node, and is full featured
                  and well tested.
                </p>
                <p>
                  It has capabilities similar to <a
                  href="https://www.gnu.org/software/make/">GNU Make</a>, <a
                  href="https://cmake.org/">CMake</a>, or <a
                  href="https://github.com/ruby/rake">Rake</a> in the Ruby
                  community.
                </p>
                <p>
                  Similar tools in the Node and JavaScript ecosystem are
                  <a href="https://gruntjs.com/">Grunt</a>
                  and <a href="https://gulpjs.com/">Gulp</a>.
                </p>
            </section><!--//docs-intro-->


            </header>
            <section class="docs-section" id="item-overview-installation">
            <h2 class="section-heading">Installation</h2>
            <p>
              Jake is primarily a CLI tool. If you want to install it globally, install it
              with the <code>-g</code> flag:
            </p>
              <pre><code class="shell hljs">$ npm install -g jake</code></pre>
            <p>
              You'll likely need to use <code>sudo</code> to install, if you don't have
              permissions on <code>/usr/local</code>.
            </p>

            <p>
              You can also install it locally as a dev dependency, like so:
            </p>
              <pre><code class="shell hljs">$ npm install --save-dev jake</code></pre>
            <p>
              Or with <code>yarn</code>:
            </p>
              <pre><code class="shell hljs">$ yarn add -D jake</code></pre>
            <p>
              You can then invoke it from inside your project via <code>npx</code>.
            </p>

            <div class="callout-block callout-block-info">
            <div class="content">
                <h4 class="callout-title">
                  <span class="callout-icon-holder mr-1">
                    <i class="fas fa-info-circle"></i>
                </span><!--//icon-holder-->
                Embedded Jake
              </h4>
              <p>
                Jake is mainly meant to be used as a CLI tool, but you can also
                embed it in your own programs, as a building block for creating
                macros, generator scripts, or anything that requires tasks that
                run with prerequisites.
              </p>
            </div><!--//content-->
          </div><!--//callout-block-->

          </section><!--//section-->

          <section class="docs-section" id="item-overview-basic-usage">
            <h2 class="section-heading">Basic usage</h2>

          <p>Run Jake from the command line, like so:</p>

          <p>
          <pre><code class="shell hljs">$ jake [options ...] [env variables ...] target</code></pre>
          </p>

          <p>Jake accepts the following options:</p>

          <div class="table-responsive my-4">
            <table class="table table-bordered">
              <tbody>
                <tr>
                  <th class="theme-bg-light">
                    -f
                    <span class="faded">/</span>
                    --jakefile
                    <span class="faded">FILE</span>
                  </th>
                  <td>
                    Use FILE as the Jakefile.
                  </td>
                </tr>
                <tr>
                  <th class="theme-bg-light">
                    -C
                    <span class="faded">/</span>
                    --directory
                    <span class="faded">DIRECTORY</span>
                  </th>
                  <td>
                    Change to DIRECTORY before running tasks.
                  </td>
                </tr>
                <tr>
                  <th class="theme-bg-light">
                    -q
                    <span class="faded">/</span>
                    --quiet
                  </th>
                  <td>
                    Do not log built-in Jake messages to standard output.
                  </td>
                </tr>
                <tr>
                  <th class="theme-bg-light">
                    -B
                    <span class="faded">/</span>
                    --always-make
                  </th>
                  <td>
                    Unconditionally make all targets.
                  </td>
                </tr>
                <tr>
                  <th class="theme-bg-light">
                    -t
                    <span class="faded">/</span>
                    -T
                    <span class="faded">/</span>
                    -ls
                    <span class="faded">/</span>
                    --tasks
                    <span class="faded">[PATTERN]</span>
                  </th>
                  <td>
                    Display the tasks (matching optional PATTERN) with descriptions, then exit.
                  </td>
                </tr>
                <tr>
                  <th class="theme-bg-light">
                    -J
                    <span class="faded">/</span>
                    --jakelibdir
                    <span class="faded">JAKELIBDIR</span>
                  </th>
                  <td>
                    Auto-import any .jake files in JAKELIBDIR (default is 'jakelib').
                  </td>
                </tr>
                <tr>
                  <th class="theme-bg-light">
                    -s
                    <span class="faded">/</span>
                    --trace
                  </th>
                  <td>
                    Enable full backtrace.
                  </td>
                </tr>
                <tr>
                  <th class="theme-bg-light">
                    -h
                    <span class="faded">/</span>
                    --help
                  </th>
                  <td>
                    Display this help message.
                  </td>
                </tr>
                <tr>
                  <th class="theme-bg-light">
                    -V
                    <span class="faded">/</span>
                    -v
                    <span class="faded">/</span>
                    --version
                  </th>
                  <td>
                    Display the Jake version.
                  </td>
                </tr>
              </tbody>
            </table>
          </div><!--//table-responsive-->

          </section><!--//section-->

          <section class="docs-section" id="item-overview-jakefiles">
            <h2 class="section-heading">Jakefiles</h2>

            <p>
              Tasks for Jake to run are defined in Jakefiles. A Jakefile is
              just executable JavaScript. You can include whatever JavaScript you
              want in it.
            </p>

            <p>
              When you run Jake, it will look for a Jakefile in the current
              diretory. Jake will recognize <code>Jakefile</code>,
              <code>Jakefile.js</code>, <code>jakefile</code>, or
              <code>jakefile.js</code> as a vaild name for a Jakefile.
            </p>

            <p>
              If it doesn't find a Jakefile in the current directory, it will
              look its parent directory, and that one's parent directory,
              recursively, until it hits the root of the filesystem. (If it
              hasn't found a Jakefile then, it errors out.)
            </p>

            <h3>Sample Jakefile</h3>

            <p>
              Here's an example of a very simple Jakefile:
            </p>

            <p>
              <pre><code class="javascript hljs">let { task, desc } = require('jake');

desc('This is the default task.');
task('default', function () {
  console.log('This is the default task.');
  console.log('Jake will run this task if you run `jake` with no task specified.');
});

desc('This is some other task. It depends on the default task');
task('otherTask', ['default'], function () {
  console.log('Some other task');
});</code></pre>
          </p>

          </section><!--//section-->

          <section class="docs-section" id="item-overview-showing-tasks">
            <h2 class="section-heading">Showing tasks</h2>

            <p>
              Passing <code>jake</code> the <code>-t</code> or
              <code>--tasks</code> flag (or the aliases <code>-T</code> / <code>-ls</code>) will
              display the full list of tasks available in a Jakefile, along with
              their descriptions:
            </p>

            <p>
              <pre><code class="shell hljs">$ jake -t
jake default       # This is the default task.
jake asdf          # This is the asdf task.
jake concat.txt    # File task, concatenating two files together
jake failure       # Failing task.
jake lookup        # Jake task lookup by name.
jake foo:bar       # This the foo:bar task
jake foo:fonebone  # This the foo:fonebone task</code></pre>
            </p>

            <p>
              Setting a value for -t/--tasks will filter the list by that value:
            </p>

            <p>
              <pre><code>$ jake -t foo
jake foo:bar       # This the foo:bar task
jake foo:fonebone  # This the foo:fonebone task</code></pre>
            </p>

            <p>
              The list displayed will be all tasks whose namespace/name contain
              the filter string.
            </p>

          </section><!--//section-->

          </article>

          <article class="docs-article" id="section-api">
            <header class="docs-header">
              <h1 class="docs-heading">API</h1>
              <section class="docs-intro">
                <p>
                  There are two APIs for defining tasks: the <strong>original
                  API</strong>, which uses a call to a
                  <code>task</code> method to define one, and an
                  <strong>experimental API</strong> which relies simply on
                  exported functions to define tasks — but the basic building
                  block of both APIs is the Task.
                </p>

	    </section><!--//docs-intro-->

            </header>

             <section class="docs-section" id="item-api-tasks">
            <h2 class="section-heading">Tasks</h2>
                <p>
                  <strong>Tasks</strong> are the basic building block of
                  execution for Jake-based build processes. Tasks can have other
                  tasks as <strong>prerequities</strong>, meaning those tasks
                  have to run before the current task can run.
                </p>
                <p>
                  Jake is smart enough to know if particular prerequisites have
                  already been run, so it doesn't run the same task twice.
                  (There is an API for reenabling tasks, so you can run them
                  multiple times if you need to.)
                </p>

          </section><!--//section-->

          <section class="docs-section" id="item-api-task-method">
            <h2 class="section-heading">The <code>task</code> method</h2>

            <p>
              The <code>task</code> method defines tasks. It has one
              required argument, the task name, and two optional arguments.
            </p>

            <p>
              <pre><code class="javascript hljs">task(name, [prerequisites], [action]);</code></pre>
            </p>

            <p>
              The <code>name</code> argument is a String defining the name of the
              task, and <code>prerequisites</code> is an optional Array of the
              list of prerequisite tasks (i.e., their names as Strings) to run first.
              (For example, you may decide to make the "clean" and "lint" tasks
              prerequisites of the "build" task.)
            </p>

            <p>
              The <code>action</code> is a Function defining the action to take
              for the task. The action is invoked with the Task
              object itself as the execution context (i.e, <code>this</code> inside
              the action function references the Task object).
            </p>

            <div class="callout-block callout-block-info">
            <div class="content">
                <h4 class="callout-title">
                  <span class="callout-icon-holder mr-1">
                    <i class="fas fa-info-circle"></i>
                </span><!--//icon-holder-->
                  Async Functions as Actions
              </h4>
              <p>
                As you'll see in the example below, Jake handles actions that are async
                functions (or any that return a Promise) without doing anything special.
                It will correctly wait until the async function or
                Promise resolves, before marking the task as complete, and moving to the
                next.
              </p>
            </div><!--//content-->
          </div><!--//callout-block-->

          <p>
            A Task is also an EventEmitter which emits the 'start' event when it
            begins to run, and the 'complete' event when it is finished.
          </p>

          <p>
            This is one way to allow asynchronous task actions to be run from
            within other tasks via either <code>invoke</code> or
            <code>execute</code>, and ensures they will complete before the rest
            of the containing task executes. See the section &quot;Running tasks
            from within other tasks,&quot; below.
          </p>

          </section><!--//section-->

          <section class="docs-section" id="item-api-desc-method">
            <h2 class="section-heading">The <code>desc</code> method</h2>

            <p>
              Use <code>desc</code> to add a string description of the task. If
              you add this description, the task will be visible when
              you run <code>jake -t</code>.
            </p>

            <div class="callout-block callout-block-info">
            <div class="content">
                <h4 class="callout-title">
                  <span class="callout-icon-holder mr-1">
                    <i class="fas fa-info-circle"></i>
                </span><!--//icon-holder-->
                  Private tasks
              </h4>
              <p>
                Tasks without a description (without a call to
                <code>desc</code>) are considered private. They will not show up
                when you run <code>jake -t</code>
              </p>
            </div><!--//content-->
          </div><!--//callout-block-->

          </section><!--//section-->

          <section class="docs-section" id="item-api-task-examples">
            <h2 class="section-heading">Task examples</h2>

            <p>
              <pre><code class="javascript hljs">let { task, desc } = require('jake');

desc('This is the foo task.');
task('foo', function () {
  console.log('This is the foo task.');
});

desc('This is the bar task.');
task('bar', function () {
  console.log('This is the bar task.');
});

desc('This async task has prerequisites.');
task('hasPrereqs', ['foo', 'bar'], async function () {
  return new Promise((resolve, reject) => {
    setTimeout(() => {
      console.log('Ran some prereqs first.');
      resolve();
    }, 2000);
  });
});</code></pre>
        </p>

          </section><!--//section-->

          <section class="docs-section" id="item-api-exported-function-tasks">
            <h2 class="section-heading">Exported function tasks (experimental)</h2>

            <p>
              Jake also supports an <strong>experimental</strong> API that
              will create tasks implicitly from any functions you export from
              your Jakefile. The name of the task will be the key you export the
              function with.
            </p>

            <p>
              For example, with the following Jakefile:
            </p>

            <p>
              <pre><code class="javascript hljs">function foo() {}
  async function bar() {}

  exports.foo = foo;
  exports.bar = bar</code></pre>
            </p>

            <p>
              Running <code>jake -t</code> wiil yield the following output:
            </p>

            <p>
              <pre><code class="shell hljs">$ jake -t
jake foo (Exported function task)
jake bar (Exported function task)</code></pre>
            </p>

          </section><!--//section-->

          <section class="docs-section" id="item-api-series-method">
            <h2 class="section-heading">The <code>series</code> method (experimental)</h2>

            <p>
              The series method allows you to chain together Jake tasks into
              single, larger tasks (similar to providing task prerequisites,
              with the original API).
            </p>

            <p>
              This approach allows you to compose larger, more complex tasks
              from smaller, simpler ones, and could be considered an example of
              recursive <a
              href="https://en.wikipedia.org/wiki/Object_composition">composition</a>.
            </p>

            <p>
              Use the <code>series</code> method like this:
            </p>

            <p>
              <pre><code class="javascript hljs">let { series } = require('jake');


function clean() {
  // Do pre-build cleanup here
};
async function lint() {
  // Shell out, do some linting
}

async function _build() {
  // This is only used internally -- always clean and lint
  // before building
}

exports.clean = clean;
exports.lint = lint;
exports.build = series(clean, lint, _build);</code></pre>
            </p>

          </section><!--//section-->

          <section class="docs-section" id="item-api-file-tasks">
            <h2 class="section-heading">File tasks</h2>
              <p>
                Create a file task by using the <code>file</code> method.
              </p>

              <p>
                File tasks create a file from one or more other files. With a
                file task, Jake will run the specified action if the file does
                not exist yet, or if it is older than the files specified by
                any prerequisite file tasks. File tasks are particularly useful for
                compiling something from a tree of source files.
              </p>

              <p>
                You can also use ordinary tasks (or directory tasks, below) as
                prereqs for file tasks.
	            </p>

              <p>
                <pre><code class="javascript hljs">let { file, desc } = require('jake');

desc('This builds a compiled JS file for production.');
file('foo-production.js', ['bar', 'foo-bar.js', 'foo-baz.js'], function () {
  // Code to concat and compile goes here
});</code></pre>
              </p>

          </section><!--//section-->

          <section class="docs-section" id="item-api-directory-tasks">
            <h2 class="section-heading">Directory tasks</h2>
              <p>
                Create a directory task by using the <code>directory</code> method.
              </p>

              <p>
                Directory-tasks create a directory for use with for file tasks.
                Jake checks for he existence of the directory, and only creates
                it if needed.
              </p>

              <p>
              <pre><code class="javascript hljs">let {directory, desc } = require('jake');

desc('This task creates creates a directory named "bar"');
directory('bar');</code></pre>
              </p>

              <p>
                A directory task can be used as a prerequisite for a
                file task, or when run from the command line.
	            </p>

          </section><!--//section-->

          <section class="docs-section" id="item-api-namespaces">
            <h2 class="section-heading">Namespaces</h2>
            <p>
	            Use <code><span class="keyword">namespace</span></code> to create
              a namespace of tasks to perform. Call it with two arguments:
	          </p>

            <p>
              <pre><code class="javascript hljs">namespace(name, namespaceTasks);</code></pre>
            </p>

            <p>
              Where <code>name</code> is the name of the namespace, and
              <code>namespaceTasks</code> is a function with calls inside it to
              <code>task</code> or <code>desc</code> defining all the tasks for that
              namespace.
            </p>

            <p>Here's an example: </p>

            <p>
              <pre><code class="javascript hljs">let { namespace, task, desk } = require('jake');

desc('This is the default task.');
task('default', function () {
  console.log('This is the default task.');
});

namespace('foo', function () {
  desc('This the foo:bar task');
  task('bar', function () {
    console.log('doing foo:bar task');
  });

  desc('This the foo:baz task');
  task('baz', ['default', 'foo:bar'], function () {
    console.log('doing foo:baz task');
  });
});</code></pre>
            </p>

            <p>
              In this example, the foo:baz task depends on the default and foo:bar
              tasks.
            </p>

          </section><!--//section-->

          <section class="docs-section" id="item-api-rules">
            <h2 class="section-heading">Rules</h2>

            <p>
              When you add a filename as a prerequisite for a task, but there is
              not a file-task defined for it, Jake can create file-tasks on the fly
              from Rules.
            </p>

            <p>
              Here's an example:
            </p>

            <p>
              <pre><code class="javascript hljs">let { rule } = require('jake');
let exec = require('child_process').execSync;

rule('.o', '.c', function () {
  let cmd = 'cc ' + this.source + ' -c -o ' + this.name;
  exec(cmd);
});</code></pre>
            </p>

            <p>
              This rule will take effect for any task-name that ends in '.o', but will
              require the existence of a prerequisite source file with the same name ending
              in '.c'.
            </p>

            <p>
              For example, with this rule, if you reference a task 'foobarbaz.o' as a
              prerequisite somewhere in one of your Jake tasks, rather than complaining about
              this file not existing, or the lack of a task with that name, Jake will
              automatically create a FileTask for 'foobarbaz.o' with the action specified in
              the rule you've defined. (The usual action would be to create 'foobarbaz.o' from
              'foobarbaz.c'). If 'foobarbaz.c' does not exist, it will recursively attempt
              synthesize a viable rule for it as well.
            </p>

            <h3>Regex patterns</h3>

            <p>
              You can use regular expressions to match file extensions as well:
            </p>

            <p>
              <pre><code class="javascript hljs">let { rule } = require('jake');
let exec = require('child_process').execSync;

rule(/\.o$/, '.c', function () {
  let cmd = 'cc ' + this.source + ' -c -o ' + this.name;
  exec(cmd);
});</code></pre>
            </p>

            <h3>Source files from functions</h3>

            <p>
              You can also use a function to calculate the name of the desired source file to
              use, instead of assuming simple suffix substitution:
            </p>

            <p>
              <pre><code class="javascript hljs">let { rule } = require('jake');

// Match .less.css or .scss.css and run appropriate preprocessor
let getSourceFilename = function (name) {
  // Strip off the extension for the filename
  return name.replace(/\.css$/, '');
};

rule(/\.\w{2,4}\.css$/, getSourceFilename, {async: true}, function () {
  // Get appropriate preprocessor for this.source, e.g., foo.less
  // Generate a file with filename of this.name, e.g., foo.less.css
});</code></pre>
            </p>

          </section><!--//section-->

          </article><!--//docs-article-->

          <article class="docs-article" id="section-advanced-usage">
            <header class="docs-header">
              <h1 class="docs-heading">Advanced usage</h1>
            </header>

            <section class="docs-section" id="item-advanced-usage-concurrent-tasks">
            <h2 class="section-heading">Concurrent tasks</h2>

            <p>
            </p>

            <p>
              Jake can run the prerequisites of a task concurrently.
            </p>

            <p>
              This only makes sense when the tasks are asynchronous and do not block the
              event loop — for example, executing shell commands. You can enable and limit the
              number of simultaneous tasks with the <code>concurrency</code> task option.
              Note: you can't necessarily know order in which concurrent tasks will finish.
            </p>

            <p>
              The folowing example uses <code>setTimout</code> to finish two concurrent
              tasks out of order:
            </p>

            <p>
            <pre><code class="javascript hljs">task('A', function() {
  console.log('Started A');
  return new Promise((resolve, reject) => {
    setTimeout(() => {
      console.log('Finished A');
      resolve();
    }, 500);
  });
});
task('B', function() {
  console.log('Started B');
  return new Promise((resolve, reject) => {
    setTimeout(() => {
      console.log('Finished B');
      resolve();
    }, 250);
  });

});
task('concurrent', ['A','B'], {concurrency: 2}, function() {
  console.log('Finished concurrent tasks');
});</code></pre>
            </p>

            </section>

             <section class="docs-section" id="item-advanced-usage-passing-parameters">
            <h2 class="section-heading">Passing parameters</h2>

            <p>
              Parameters can be passed on the <code>jake</code> CLI in two ways:
              <strong>task-specific arguments</strong>, and <strong>environment variables</strong>.
            </p>

            <h3>Task arguments</h3>

            <p>
              To pass arguments to a Jake task, enclose them in square braces,
              separated by commas, after the name of the task on the command-line. For
              example, with the following Jakefile:
            </p>

            <p>
<pre><code class="javascript hljs">let { task, desc } = require('jake');

desc('This is an awesome task.');
task('awesome', function (a, b, c) {
  console.log(a, b, c);
});</code></pre>
            </p>

            <p>
              You could run <code>jake</code> like this:
            </p>

            <p>
              <pre><code class="shell hljs">$ jake awesome[hoge,piyo,fuga]</code></pre>
            </p>

            <p>
              And you'd get the following output:
            </p>

            <p>
              <pre><code class="shell hljs">hoge piyo fuga</code></pre>
            </p>

            <p>
              Note that you <em>cannot</em> uses spaces between the commas separating the parameters.
            </p>

            <div class="callout-block callout-block-info">
            <div class="content">
                <h4 class="callout-title">
                  <span class="callout-icon-holder mr-1">
                    <i class="fas fa-info-circle"></i>
                </span><!--//icon-holder-->
                For zsh users
              </h4>
              <p>
                You will need to escape the brackets or wrap in single quotes
                like this to pass parameters:
              </p>

              <p>
                <pre><code class="shell hljs">$ jake 'awesome[foo,bar,baz]'</code></pre>
              </p>

              <p>
                Another solution is to deactivate permanently file-globbing for the <code>jake</code>
                command. You can do this by adding this line to your <code>.zshrc</code> file:
              </p>

              <p>
                <pre><code>alias jake=&quot;noglob jake&quot;</code></pre>
              </p>

            </div><!--//content-->
          </div><!--//callout-block-->

            <h3>Environment variables</h3>

            <p>
              Any parameters passed after the Jake task that contain an equals sign (=) will
              be added to process.env.
            </p>

            <p>
              With the following Jakefile:
            </p>
            <p>
              <pre><code class="javascript hljs">let { task, desc } = require('jake');

desc('This is an awesome task.');
task('awesome', function (a, b, c) {
  console.log(a, b, c);
  console.log(process.env.qux, process.env.frang);
});</code></pre>
            </p>

            <p>
              You could run <code>jake</code> like this:
            </p>

            <p>
              <pre><code>jake awesome[hoge,piyo,fuga] qux=zoobie frang=asdf</code></pre>
            </p>

            <p>
              And you'd get the following output:
            </p>

            <p>
            <pre><code>hoge piyo fuga
zoobie asdf</code></pre>
            </p>

            <div class="callout-block callout-block-info">
            <div class="content">
                <h4 class="callout-title">
                  <span class="callout-icon-holder mr-1">
                    <i class="fas fa-info-circle"></i>
                </span><!--//icon-holder-->
                No args = default task
              </h4>
              <p>
                Running the <code>jake</code> command with no arguments at all runs the default task.
              </p>

            </div><!--//content-->
          </div><!--//callout-block-->


          </section><!--//section-->

          <section class="docs-section" id="item-advanced-usage-programmatic-tasks">
            <h2 class="section-heading">Programmatic tasks</h2>

          <p>
            Jake supports the ability to run a task from within another task via the
            <code>invoke</code> and <code>execute</code> methods.
          </p>

          <p>
            The <code>invoke</code> method will run the desired task, along with its prerequisites:
          </p>

          <p>
            <pre><code class="javascript hljs">let { task, desc, Task } = require('jake');

desc('Calls the foo:bar task and its prerequisites.');
task('invokeFooBar', function () {
  // Calls foo:bar and its prereqs
  Task['foo:bar'].invoke();
});</code></pre>
          </p>


          <p>
            The <code>invoke</code> method will only run the task once, even if you call it repeatedly.
          </p>

          <p>
            <pre><code class="javascript hljs">let { task, desc, Task } = require('jake');

desc('Calls the foo:bar task and its prerequisites.');
task('invokeFooBarOnce', function () {
  let t = Task['foo:bar'];
  // Calls foo:bar and its prereqs
  t.invoke();
  // No-op
  t.invoke();
});</code></pre>
          </p>

          <p>
            The <code>execute</code> method runs the desired task without its prerequisites:
          </p>

          <p>
            <pre><code class="javascript hljs">let { task, desc, Task } = require('jake');

desc('Calls the foo:bar task without its prerequisites.');
task('executeFooBar', function () {
  // Calls foo:bar without its prereqs
  Task['foo:baz'].execute();
});</code></pre>
          </p>

          <p>
            Calling <code>execute</code> repeatedly <strong>will</strong> run the desired
            task repeatedly.
          </p>

          <p>
            <pre><code class="javascript hljs">let { task, desc, Task } = require('jake');

desc('Calls the foo:bar task without its prerequisites.');
task('executeFooBarRepeatedly', function () {
  // Calls foo:bar without its prereqs
  let t = Task['foo:bar'];
  t.execute();
  // Can keep running this over and over
  t.execute();
  t.execute();
});</code></pre>
          </p>

          <p>
            If you want to run the task and its prerequisites more than once, you can use
            <code>invoke</code> with the <code>reenable</code> method.
          </p>

          <p>
            <pre><code class="javascript hljs">let { task, desc, Task } = require('jake');

desc('Calls the foo:bar task and its prerequisites.');
  task('invokeFooBar', function () {
  let t = Task['foo:bar'];
  // Calls foo:bar and its prereqs
  t.invoke();
  // Does nothing
  t.invoke();
  // Only re-runs foo:bar, but not its prerequisites
  t.reenable();
  t.invoke();
});</code></pre>
          </p>

          <p>
            The <code>reenable</code> method takes a single Boolean arg, a 'deep' flag, which reenables
            the task's prerequisites if set to true.
          </p>

          <p>
            <pre><code class="javascript hljs">let { task, desc, Task } = require('jake');

desc('Calls the foo:bar task and its prerequisites.');
task('invokeFooBar', function () {
  let t = Task['foo:bar'];
  // Calls foo:bar and its prereqs
  t.invoke();
  // Does nothing
  t.invoke();
  // Re-runs foo:bar and all of its prerequisites
  t.reenable(true);
  t.invoke();
});</code></pre>
          </p>

          <p>
            It's easy to pass params on to a sub-task run via <code>invoke</code> or <code>execute</code>:
          </p>

          <p>
            <pre><code class="javascript hljs">let { task, desc, Task } = require('jake');

desc('Passes params on to other tasks.');
task('passParams', function (...args) {
  // Calls foo:bar, passing along current args
  Task['foo:bar'].invoke(...args);
});</code></pre>
          </p>

          </section><!--//section-->

          <section class="docs-section" id="item-advanced-usage-evented-tasks">
            <h2 class="section-heading">Evented tasks</h2>

            <p>
              Tasks are EventEmitters. The Jake runner does a pretty good job of managing
              task asynchrony, but in some cases, particularly when running tasks
              programmatically using <code>invoke</code>, you may want to listen
              specifically for a particular task's events.
            </p>

            <p>
              Following are the events a task may emit:
            </p>

          <div class="table-responsive my-4">
            <table class="table table-bordered">
              <tbody>
                <tr>
                  <th class="theme-bg-light">
                    start
                  </th>
                  <td>
                    Emitted before the task's action is run. (Will also emit for tasks that have no action defined.)
                  </td>
                  <td>
                    (No value)
                  </td>
                </tr>
                <tr>
                  <th class="theme-bg-light">
                    skip
                  </th>
                  <td>
                    Emitted when a task is specified as a prereq for another task, but it has already been run.
                  </td>
                  <td>
                    (No value)
                  </td>
                </tr>
                <tr>
                  <th class="theme-bg-light">
                    error
                  </th>
                  <td>
                    Emitted when there is an error running a task's action.
                    (This also applies to rejected Promises in async actions.) If
                    there is no listener for the error event on the Jake task,
                    there will be a global Jake failure, and the program will
                    exit.
                  </td>
                  <td>
                    The thrown error
                  </td>
                </tr>
                <tr>
                  <th class="theme-bg-light">
                    complete
                  </th>
                  <td>
                    Emitted when a task successfully completes.
                  </td>
                  <td>
                    The value returned by the task
                  </td>
                </tr>
              </tbody>
            </table>
          </div><!--//table-responsive-->

          <p>
            <pre><code class="javascript hljs">let { task, desc, Task } = require('jake');

desc('Calls the async foo:baz task and its prerequisites.');
task('invokeFooBaz', async function () {
  let t = Task['foo:baz'];
  return new Promise((resolve, reject) => {
    t.addListener('complete', () => {
      console.log('Finished executing foo:baz');
      // Maybe run some other code
      // ...
      resolve();
    });
    // Kick off foo:baz
    t.invoke();
  });
});</code></pre>
          </p>

          <p>
            If you want to handle the errors in a task in some specific way, you
            can set a listener for the 'error' event, like so:
          </p>

          <p>
            <pre><code class="javascript hljs">let { task, namespace, Task } = require('jake');

namespace('vronk', function () {
  task('groo', function () {
    var t = Task['vronk:zong'];
    t.addListener('error', function (e) {
      console.log(e.message);
    });
    t.invoke();
  });

  task('zong', function () {
    throw new Error('OMFGZONG');
  });
});</code></pre>
          </p>

            <div class="callout-block callout-block-info">
            <div class="content">
                <h4 class="callout-title">
                  <span class="callout-icon-holder mr-1">
                    <i class="fas fa-info-circle"></i>
                </span><!--//icon-holder-->
                Unhandled task errors
              </h4>
              <p>
                If no specific listener is set for the <strong>error</strong>
                event, errors are handled by Jake's built-in error handling — and your
                program will exit with a non-zero exit code.
              </p>
            </div><!--//content-->
          </div><!--//callout-block-->

	        </section><!--//section-->

          <section class="docs-section" id="item-advanced-usage-aborting-tasks">
            <h2 class="section-heading">Aborting tasks</h2>

            <p>
              Any unhandled error in a task will abort the current task, and
              cause your program to exit with a non-zero exit code.
            </p>

            <p>
              Alternatively you can use the <code>fail</code> method, which allows
              you to specify a custom message to be printed to stderr. You may
              also specify a number to use as the exit code.
            </p>


          <p>
            <pre><code class="javascript hljs">let { task, fail } = require('jake');

task('failTaskQuestionCustomStatus', function () {
  fail('Yikes, something went wrong', 42);
});</code></pre>
          </p>

          <p>
            If you run this task, the process will die with an exit code of 42,
            and the specified message will get printed to stderr.
          </p>

	        </section><!--//section-->

          <section class="docs-section" id="item-advanced-usage-modularizing">
            <h2 class="section-heading">Modularizing</h2>

            <p>
              Jake will automatically look for files with a .js extension in a 'jakelib'
              directory in your project, and load them (using <code>require</code>) after
              loading your main jakefile.js. (The directory name can be overridden using the
              -J/--jakelibdir command-line option.)
            </p>

            <p>
              This allows you to break your tasks up over multiple files -- a good way to do
              it is one namespace per file: e.g., a <code>zardoz</code> namespace full of tasks in
              'jakelib/zardox.js'.
            </p>

            <p>
              Note that these .js files in the jakelib each run in their own
              module-context, so they don't have access to each others' data. However,
              the Jake API methods, and the task-hierarchy are globally available, so
              you can use tasks in any file as prerequisites for tasks in any other,
              just as if everything were in a single file.
            </p>

            <p>
              And of course environment variables set on the command line are
              likewise also naturally available to code in all those files, in
              process.env.
            </p>

	        </section><!--//section-->

          </article><!--//docs-article-->

          <article class="docs-article" id="section-utility-tasks">
            <header class="docs-header">
              <h1 class="docs-heading">Utility tasks</h1>
              <section class="docs-intro">
                <p>
                  Jake ships with a number of built-in utility tasks that make
                  the repetitive work of building and releasing easier.
                </p>
	            </section><!--//docs-intro-->
            </header>

             <section class="docs-section" id="item-utility-tasks-package-task">
            <h2 class="section-heading">PackageTask</h2>

            <p>
              When you create a PackageTask, it programmatically creates a set of
              tasks for packaging up your project for distribution. Here's an
              example:
            </p>

            <p>
            <pre><code class="javascript hljs">let { packageTask } = require('jake');

packageTask('fonebone', 'v0.1.2112', function () {
  var fileList = [
    'jakefile.js'
  , 'README.md'
  , 'package.json'
  , 'lib/*'
  , 'bin/*'
  , 'tests/*'
  ];
  this.packageFiles.include(fileList);
  this.needTarGz = true;
  this.needTarBz2 = true;
});</code></pre>
            </p>

            <p>
              This will automatically create a 'package' task that will assemble the
              specified files in 'pkg/fonebone-v0.1.2112,' and compress them
              according to the specified options. After running <code>jake
              package</code>, you'll have the following in pkg/:
            </p>

<pre><code>fonebone-v0.1.2112
fonebone-v0.1.2112.tar.bz2
fonebone-v0.1.2112.tar.gz </code></pre>

            <p>
              PackageTask also creates a 'clobber' task that removes the pkg/ directory.
            </p>


            <ul>
              <li><code>name</code> {String} The name of the project</li>
              <li><code>version</code> {String} The project version-string</li>
              <li><code>prereqs</code> {Array} Tasks to run before packaging</li>
              <li><code>packageDir</code> {String='pkg'} The directory-name to use for packaging the software</li>
              <li><code>packageFiles</code> {jake.FileList} The list of files and directories to include in the package-archive</li>
              <li><code>needTar</code> {Boolean=false} If set to true, uses the <code>tar</code> utility to create a gzip .tgz archive of the package</li>
              <li><code>needTarGz</code> {Boolean=false} If set to true, uses the <code>tar</code> utility to create a gzip .tar.gz archive of the package</li>
              <li><code>needTarBz2</code> If set to true, uses the <code>tar</code> utility to create a bzip2 .bz2 archive of the package</li>
              <li><code>needJar</code> {Boolean=false} If set to true, uses the <code>jar</code> utility to create a .jar archive of the package</li>
              <li><code>needZip</code> {Boolean=false} If set to true, uses the <code>zip</code> utility to create a .zip archive of the package</li>
              <li><code>manifestFile</code> {String=null} Can be set to point the <code>jar</code> utility at a manifest file to use in a .jar archive. If unset, one will be automatically created by the <code>jar</code> utility. This path should be relative to the root of the package directory (this.packageDir above, likely 'pkg')</li>
              <li><code>tarCommand</code> {String='tar'} The shell-command to use for creating tar archives.</li>
              <li><code>jarCommand</code> {String='jar'} The shell-command to use for creating jar archives.</li>
              <li><code>zipCommand</code> {String='zip'} The shell-command to use for creating zip archives.</li>
              <li><code>archiveNoBaseDir</code> {Boolean=false} Simple option for performing the archive on the contents of the directory instead of the directory itself</li>
              <li><code>archiveChangeDir</code> {String=null} Equivalent to the '-C' command for the <code>tar</code> and <code>jar</code> commands. (&quot;Change to this directory before adding files.&quot;)</li>
              <li><code>archiveContentDir</code> {String=null} Specifies the files and directories to include in the package-archive. If unset, this will default to the main package directory -- i.e., name + version.</li>
            </ul>
          </section><!--//section-->

          <section class="docs-section" id="item-utility-tasks-file-list">
            <h2 class="section-heading">FileList</h2>

            <p>
              Jake's FileList takes a list of glob-patterns and file-names, and lazy-creates a
              list of files to include. Instead of immediately searching the filesystem to
              find the files, a FileList holds the pattern until it is actually used.
            </p>

            <p>
              When any of the normal JavaScript Array methods (or the <code>toArray</code> method) are
              called on the FileList, the pending patterns are resolved into an actual list of
              file-names.
            </p>

            <p>
              To build the list of files, use FileList's <code><span
              class="keyword">include</span></code> and <code>exclude</code> methods:
            </p>

            <p>
            <pre><code class="javascript hljs">let list = new jake.FileList();
list.include('foo/*.txt');
list.include(['bar/*.txt', 'README.md']);
list.include('Makefile', 'package.json');
list.exclude('foo/zoobie.txt');
list.exclude(/foo\/src.*.txt/);
console.log(list.toArray());</code></pre>
            </p>

            <p>
              The <code>include</code> method can be called either with an array of items, or multiple
              single parameters. Items can be either glob-patterns, or individual file-names.
            </p>

            <p>
              The <code>exclude</code> method will prevent files from being included in the list. These
              files must resolve to actual files on the filesystem. It can be called either
              with an array of items, or multiple single parameters. Items can be
              glob-patterns, individual file-names, string-representations of
              regular-expressions, or regular-expression literals.
            </p>

          </section><!--//section-->

          <section class="docs-section" id="utility-tasks-publish-task">
              <h2 class="section-heading">PublishTask</h2>

              <p>
                The PublishTask will automatically create a <code>publish</code> task which
                performs the following steps:
              </p>

              <ol>
                <li>Bump the version number in your package.json</li>
                <li>Commit change in git, push it to GitHub</li>
                <li>Create a git tag for the version</li>
                <li>Push the tag to GitHub</li>
                <li>Package the new version of your project</li>
                <li>Publish it to NPM</li>
                <li>Clean up the package</li>
              </ol>

              <p>
                If you want to publish to a private NPM repository or some other
                type of repo, you can specify a custom publishing command:
              </p>

            <p>
            <pre><code class="javascript hljs">let { publishTask } = require('jake');

publishTask('zerb', function () {
  this.packageFiles.include([
  , 'index.js'
  , 'package.json'
    ]);

  // Publishes using the gemfury cli
  // `%filename` will be replaced with the package filename
  this.publishCmd = 'fury push %filename';
});</code></pre>
            </p>

          </section><!--//section-->
          </article><!--//docs-article-->


          <footer class="footer">
            <div class="container text-center py-5">
                <small class="copyright">Template Copyright &copy; <a href="https://themes.3rdwavemedia.com/" target="_blank">3rd Wave Media</a></small>
                <ul class="social-list list-unstyled pt-4 mb-0">
                  <li class="list-inline-item"><a href="docs-page.html"><i class="fas fa-edit fa-fw"></i></a></li>
                  <li class="list-inline-item"><a href="https://github.com/jakejs/jake"><i class="fab fa-github fa-fw"></i></a></li>
                  <li class="list-inline-item"><a href="https://www.npmjs.com/package/jake"><i class="fab fa-npm fa-fw"></i></a></li>
                  <li class="list-inline-item"><a href="https://twitter.com/mde"><i class="fab fa-twitter fa-fw"></i></a></li>
                </ul><!--//social-list-->
            </div>
          </footer>
        </div>
      </div>
    </div><!--//docs-wrapper-->



    <!-- Javascript -->
    <script src="assets/plugins/jquery-3.4.1.min.js"></script>
    <script src="assets/plugins/popper.min.js"></script>
    <script src="assets/plugins/bootstrap/js/bootstrap.min.js"></script>


    <!-- Page Specific JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.8/highlight.min.js"></script>
    <script src="assets/js/highlight-custom.js"></script>
    <script src="assets/plugins/jquery.scrollTo.min.js"></script>
    <script src="assets/plugins/lightbox/dist/ekko-lightbox.min.js"></script>
    <script src="assets/js/docs.js"></script>

</body>
</html>

